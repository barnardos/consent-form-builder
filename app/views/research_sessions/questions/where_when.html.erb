<%= c('Step') do %>
  <%= c('Title', text: 'When & when') %>

  <%= c('Form', action: wizard_path, patch: true) do %>
    <%= c('OfManyChoiceControl',
      id: 'research_session[where_when_enabled]',
      name:'where_when_enabled',
      collection: "research_session[#{:where_when_enabled}]",
      choices: { true: 'Yes', false: 'No' },
      choices_selected: [@research_session.where_when_enabled.to_s],
      legend: t('helpers.legend.research_session.where_when_enabled'),
      choice_type: 'single',
      errored: @research_session.errors['where_when_enabled'].present?,
      validation: @research_session.errors['where_when_enabled'][0]
    ) %>

  <%= c('ChoiceControlledContent',
      is_active: (@research_session.where_when_enabled.present? && [@research_session.where_when_enabled.to_s].include?('true')),
      controlled_by: '[id="research_session[true]"]') do %>
        <%= c('SinglelineTextControl',
          id: 'research_session[when_text]',
          name: 'when_text',
          value: @research_session.when_text,
          label: t('research_session_attr_labels.when_text'),
          hint: 'e.g. Monday 27th September 2018 at 3:00pm',
          size: 24,
          errored: @research_session.errors['when_text'].present?,
          validation: @research_session.errors['when_text'][0]
        ) %>

        <%= c('SinglelineTextControl',
            id: 'research_session[duration]',
            name: 'duration',
            value: @research_session.duration,
            label: t('research_session_attr_labels.duration'),
            size: 24,
            errored: @research_session.errors['duration'].present?,
            validation: @research_session.errors['duration'][0]
          ) %>

          <%= c('SinglelineTextControl',
          id: 'research_session[location]',
          name: 'location',
          value: @research_session.location,
          label: t('research_session_attr_labels.location'),
          size: 24,
          errored: @research_session.errors['location'].present?,
          validation: @research_session.errors['location'][0]
        ) %>

        <%= c('SinglelineTextControl',
          id: 'research_session[participant_equipment]',
          name: 'participant_equipment',
          value: @research_session.participant_equipment,
          label: t('research_session_attr_labels.participant_equipment'),
          size: 24,
          errored: @research_session.errors['participant_equipment'].present?,
          validation: @research_session.errors['participant_equipment'][0]
        ) %>
        
        <%= c('SinglelineTextControl',
          id: 'research_session[food_provided]',
          name: 'food_provided',
          value: @research_session.food_provided,
          label: t('research_session_attr_labels.food_provided'),
          size: 24,
          errored: @research_session.errors['food_provided'].present?,
          validation: @research_session.errors['food_provided'][0]
        ) %>
  <% end %>
     <%= render partial: 'submit_step' %>
  <% end %>
<% end %>

<% if @research_session.where_when_enabled %>
  <%= c('PreviewInformation') do %>
      <%= c('HeadingOne', text: t('preview.able_to_consent.session_details.heading')) %>     
  <% end %>
<% end %>
