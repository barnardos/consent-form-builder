<%= c('Step') do %>
  <%= c('Title', text: 'Incentives') %>

  <%= c('Form', action: wizard_path, patch: true) do %>
    <%= c('OfManyChoiceControl',
      id: 'research_session[incentives_enabled]',
      name:'incentives_enabled',
      collection: "research_session[#{:incentives_enabled}]",
      choices: [
        {
          id: 'incentives_enabled_true',
          value: true,
          label: 'Yes'
        },
        {
          id: 'incentives_enabled_false',
          value: false,
          label: 'No' 
        }
      ],
      choices_selected: @research_session.incentives_enabled.nil? ? [false] : [@research_session.incentives_enabled],
      legend: t('helpers.legend.research_session.incentives_enabled'),
      choice_type: 'single',
      errored: @research_session.errors['incentives_enabled'].present?,
      validation: @research_session.errors['incentives_enabled'][0]
    ) %>

  <%= c('ChoiceControlledContent',
      is_active: (@research_session.incentives_enabled.present? && [@research_session.incentives_enabled.to_s].include?('true')),
      controlled_by: '[id="research_session[incentives_enabled_true]"]') do %>

          <%= c('OfManyChoiceControl',
            id: 'research_session[payment_type]',
            name:'payment_type',
            collection: "research_session[#{:payment_type}]",
            choices: PaymentType::CHOICES,
            choices_selected: [@research_session.payment_type],
            legend: 'What form will the incentive take?',
            choice_type: 'single',
            errored: @research_session.errors['payment_type'].present?,
            validation: @research_session.errors['payment_type'][0]
          ) %>   
      <% end %>
     <%= render partial: 'submit_step' %>
  <% end %>
<% end %>
