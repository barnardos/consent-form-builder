<%= c('Step') do %>
  <%= c('Title', text: 'Methodologies') %>

  <%= c('ErrorSummary', errors: @research_session.errors.to_hash) if @research_session.errors.any? %>

  <%= c('Form', action: wizard_path, patch: true) do %>
    <%= c('OfManyChoiceControl',
      id: 'research_session[methodologies][]',
      name:'methodologies',
      collection: "research_session[#{:methodologies}][]",
      choices: Methodologies::NAME_VALUES,
      choices_selected: @research_session.methodologies,
      legend: 'How will you be gathering information?',
      choiceType: 'multi',
      errored: @research_session.errors['methodologies'].present?,
      validation: @research_session.errors['methodologies'][0]
    ) %>

    <%= c('OptionalField',
      isActive: (@research_session.methodologies.include?("other") if @research_session.methodologies.present?),
      controlled_by: '[id="research_session[other]"]') do %>
      <%= c('SinglelineTextControl',
        id: 'research_session[other_methodology]',
        name: 'other_methodology',
        value: @research_session.other_methodology,
        label: t('research_session_attr_labels.other_methodology'),
        size: 24,
        errored: @research_session.errors['other_methodology'].present?,
        validation: @research_session.errors['other_methodology'][0]
      ) %>
    <% end %>

    <%= c('Submit', text: 'Continue') %>
  <% end %>
<% end %>
